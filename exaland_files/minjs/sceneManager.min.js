var HLS={raf:null,sceneStart:0,sceneProgress:0,modelsParams:null,sceneId:null,defaultScene:"exaland",shotFlora:!0,tempColor:0,color:new THREE.Vector3,lumi:0,landColorChange:!1,initScenes:{},scenes:{},scenesAddons:{},loadParams:function(a){void 0!==a.speed&&(HLE.BASE_MOVE_SPEED=STATUS.VR||STATUS.CARDBOARD?1*a.speed:a.speed);HL.cameraGroup.position.y=void 0!==a.cameraPositionY?a.cameraPositionY:50;HL.cameraGroup.updateMatrix();HL.cameraGroup.updateMatrixWorld();HL.sea.position.y=void 0!==a.seaLevel?
a.seaLevel:0;null!==HL.scene.fog&&(HL.scene.fog.density=void 0!==a.fogDeensity?a.fogDensity:1.5E-4);HLS.modelsParams=void 0!==a.modelsParams?a.modelsParams:null;void 0!==a.tiles?(HL.land.geometry=new THREE.PlaneBufferGeometry(HLE.WORLD_WIDTH,HLE.WORLD_WIDTH,a.tiles,a.tiles),HL.land.geometry.rotateX(-Math.PI/2),HL.land.material.uniforms.worldModuleWidth.value=HLE.WORLD_WIDTH/a.tiles):HL.land.material.uniforms.worldModuleWidth.value=HLE.WORLD_WIDTH/HL.land.geometry.parameters.widthSegments;void 0!==
a.repeatUV&&(HL.land.material.uniforms.repeatUV.value=new THREE.Vector2(a.repeatUV,a.repeatUV));void 0!==a.bFactor&&(HL.land.material.uniforms.bFactor.value=a.bFactor);void 0!==a.cFactor&&(HL.land.material.uniforms.cFactor.value=a.cFactor);void 0!==a.landSeed&&(HL.land.material.uniforms.landSeed.value=a.landSeed);void 0!==a.map&&(HL.land.material.uniforms.map.value=HL.textures[a.map]);void 0!==a.map2&&(HL.land.material.uniforms.map2.value=HL.textures[a.map2]);void 0!==a.mapSand&&(HL.land.material.uniforms.mapSand.value=
HL.textures[a.mapSand]);void 0!==a.natural&&(HL.land.material.uniforms.natural.value=a.natural);void 0!==a.rainbow&&(HL.land.material.uniforms.rainbow.value=a.rainbow);void 0!==a.squareness&&(HL.land.material.uniforms.squareness.value=a.squareness);void 0!==a.landRGB&&HLC.land.set(a.landRGB);void 0!==a.horizonRGB&&(HLC.horizon.set(a.horizonRGB),HLC.tempHorizon.set(a.horizonRGB));void 0!==a.skyMap&&(HL.materials.sky.map=HL.textures[a.skyMap]);void 0!==a.landColorChange&&(HLS.landColorChange=a.landColorChange);
void 0!==a.centerPath&&(HL.materials.land.uniforms.withCenterPath.value=HLE.CENTER_PATH=a.centerPath);HL.materials.land.uniforms.hardMix.value=void 0!==a.hardMix?a.hardMix:!0;HL.cameraCompanion.material.map=HL.dynamicTextures.textbox.texture;HL.cameraCompanion.material.needsUpdate=!0},startScene:function(a){HLS.sceneId=a;STATUS.VR?HL.VREffect.cancelAnimationFrame(HLS.raf):window.cancelAnimationFrame(HLS.raf);HLE.reactiveMoveSpeed=HLE.moveSpeed=0;void 0!==HLSP[a]&&HLS.loadParams(HLSP[a]);null!==HL.scene.fog&&
(HL.scene.fog.density=2.5E-4);HL.sky.visible=!0;HL.cameraCompanion.visible=!1;void 0!==HL.glitchPlane.material.materialShader&&(HL.glitchPlane.material.materialShader.uniforms.amount.value=0);HLH.destroyAllModels();HL.cameraGroup.rotation.x=0;HL.cameraGroup.rotation.y=0;HL.cameraGroup.rotation.z=0;HL.cameraCompanion.visible=!1;if(void 0!==HLS.initScenes[a])HLS.initScenes[a]();HLS.sceneStart=frameCount;HLS.raf=STATUS.VR?HL.VREffect.requestAnimationFrame(HLS.scenes[a]||HLS.scenes.standard):window.requestAnimationFrame(HLS.scenes[a]||
HLS.scenes.standard)}};
HLS.scenes.standard=function(){HLS.raf=STATUS.VR?HL.VREffect.requestAnimationFrame(HLS.scenes.standard):window.requestAnimationFrame(HLS.scenes.standard);.95<HLR.fft[0]&&(HL.materials.land.uniforms.landSeed.value+=.001*HLR.fft[0]);HLE.reactiveMoveSpeed=HLE.BASE_MOVE_SPEED+7*(HLR.smoothFft[0]+HLR.smoothFft[1]+HLR.smoothFft[2])*HLE.BASE_MOVE_SPEED;HLE.moveSpeed=HLE.reactiveMoveSpeed*(STATUS.VR||STATUS.ISMOBILE?.65:1);HLE.moveSpeed*=HLE.acceleration;HLR.tempNoiseFreq=7-3*HLR.fft[2];HLE.noiseFrequency=
HLR.tempNoiseFreq;HLE.noiseFrequency2+=.3*Math.min(0,HLR.fft[1]-HLR.fft[2]);if(HLS.scenesAddons[HLS.sceneId])HLS.scenesAddons[HLS.sceneId]()};HLS.initScenes.exaland=function(){console.log(" exaland scene init")};var randomDebounce1=!0,randomDebounce2=!0;function isRegisteredKick(){return!1}var elephantDebounce=!0;
HLS.scenesAddons.exaland=function(){.97<HLR.fft[0]&&HLR.randomizeTrigger?randomDebounce1&&(HLS.randomizeLand(),randomDebounce1=!1):randomDebounce1=!0;HLR.objectsTrigger&&(.9<HLR.fft[0]&&HLH.startGroup(["civilization",.3,0,"xyz",!0,-4,!1]),.28<HLR.fft[2]&&HLH.startGroup(["everything",.5,13,"xyz",!0,THREE.Math.randInt(2*HLE.WORLD_HEIGHT,.15*HLE.WORLD_HEIGHT),!0]),.78<HLR.fft[1]&&HLH.startGroup(["bigfishes",.25,1,"z",!1,THREE.Math.randInt(2*HLE.WORLD_HEIGHT,.15*HLE.WORLD_HEIGHT),!0]));HL.sky.visible=
.5<HLR.fft[1]?!1:!0;HLR.textTrigger&&(.88<HLR.fft[0]?(0==HL.cameraCompanion.visible&&HLS.textGlitchTexture(),HL.cameraCompanion.visible=!0):HL.cameraCompanion.visible=!1);HLS.lumi=Math.min(HLR.fft[2]+.2*HLR.fft[0],1);HLC.horizon.setRGB(HLC.tempHorizon.r+HLS.lumi,HLC.tempHorizon.g+HLS.lumi,HLC.tempHorizon.b+HLS.lumi);1==HLR.glitchEffect&&void 0!==HL.glitchPlane.material.materialShader&&(HL.glitchPlane.material.materialShader.uniforms.iTime.value+=.1,HL.glitchPlane.material.materialShader.uniforms.amount.value=
.15*HLR.fft[2])};HLS.scenesAddons.hyperland=function(){HLS.lumi=.3*HLR.fft[2];HLC.horizon.setRGB(HLC.tempHorizon.r+HLS.lumi,HLC.tempHorizon.g+HLS.lumi,HLC.tempHorizon.b+HLS.lumi)};HLS.scenesAddons.blackscene=function(){HLS.lumi=.05*HLR.fft[2];HLC.horizon.setRGB(HLC.tempHorizon.r+HLS.lumi,HLC.tempHorizon.g+HLS.lumi,HLC.tempHorizon.b+HLS.lumi)};function pickRandomPropertyHL(){var a,b;for(b in window)if("HL"==b.substr(0,2)&&.1>Math.random()&&"HL"!=b){a=b;break}return window[a]}var cartello;
HLS.textGlitchTexture=function(){var a=pickRandomPropertyHL();try{cartello=JSON.stringify(a),cartello=cartello.split(",")}catch(c){for(cartello=[],a=0;50>a;a++)cartello.push(16777215*Math.random())}a=16+64*Math.random();HL.dynamicTextures.textbox.c.clearRect(0,0,HL.dynamicTextures.textbox.width,HL.dynamicTextures.textbox.height);HL.dynamicTextures.textbox.c.font=a+"px 'Space Mono'";HL.dynamicTextures.textbox.c.fillStyle="white";for(var b=Math.floor(Math.random()*cartello.length);b<cartello.length;b++)HL.dynamicTextures.textbox.c.fillText(cartello[b],
20,10+1.2*a*b);HL.dynamicTextures.textbox.texture.needsUpdate=!0};
HLS.randomizeLand=function(){console.log("randomized land");var a=2+Math.round(6*Math.random());HL.land.material.uniforms.repeatUV.value=new THREE.Vector2(a,a);HL.land.material.uniforms.bFactor.value=Math.random();HL.land.material.uniforms.cFactor.value=Math.random();HL.land.material.uniforms.landSeed.value=100*Math.random();null!==HL.stereoEffect&&(HL.stereoEffect=new THREE.StereoEffect(HL.renderer),HL.stereoEffect.setSize(window.innerWidth,window.innerHeight));.3>Math.random()?(HL.land.material.uniforms.map.value=
HL.dynamicTextures.textbox.texture,HL.land.material.uniforms.map2.value=HL.dynamicTextures.textbox.texture):(HL.land.material.uniforms.map.value=HL.textures[.5<Math.random()?"land"+(1+Math.round(4*Math.random())):"white"],HL.land.material.uniforms.map2.value=HL.textures["land"+(1+Math.round(4*Math.random()))]);HL.land.material.uniforms.squareness.value=.05*Math.random();HL.sky.material.uniforms.mixFactor.value=Math.random();HL.sky.geometry.rotateY(Math.random()*Math.PI);HLC.land.set(HLC.palette.getRandom());
HLC.horizon.set(HLC.palette.getRandom());HLC.tempHorizon.set(HLC.horizon);HLC.sea.set(.5*HLC.palette.getRandom())};
window.addEventListener("HLEload",function(){function a(a){a.targetTouches?(c.x=a.targetTouches[0].clientX,c.y=a.targetTouches[0].clientY):(c.x=a.clientX,c.y=a.clientY);c.x=c.x/window.innerWidth*2-1;c.y=2*-(c.y/window.innerHeight)+1;b.setFromCamera(c,HL.camera);a=b.intersectObjects(HL.scene.children);if(void 0!==a[0]&&void 0!==a[0].object.key){var d,f=HL.models,g=0,e;for(e in f)Math.random()<1/++g&&(d=e);a[0].object.geometry=HL.models[d].geometry;a[0].object.material=HL.models[d].material}}HLS.startScene(HLS.defaultScene);
var b=new THREE.Raycaster,c=new THREE.Vector2;window.addEventListener("click",a,!1);window.addEventListener("touchstart",a,!1)});
